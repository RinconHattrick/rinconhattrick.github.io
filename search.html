---
layout: default
title: "Resultados de Búsqueda"
---

<section class="section" role="main">
  <div class="container">
    <h1
      class="title has-text-centered has-text-link"
      role="heading"
      aria-level="1"
    >
      Resultados de búsqueda
    </h1>

    <input
      type="text"
      id="search-input"
      class="input"
      placeholder="Buscar..."
      aria-label="Buscar artículos"
      aria-describedby="search-hint"
    />
    <p id="search-hint" class="help">
      Escribe al menos 3 caracteres para comenzar a buscar.
    </p>

    <div
      id="search-results"
      class="content mt-5"
      aria-live="polite"
      aria-relevant="additions"
    ></div>
  </div>
</section>

<script>
  const searchJsonUrl = "{{ '/assets/json/search.json' | relative_url }}";

  async function fetchSearchData(query) {
    try {
      const response = await fetch(searchJsonUrl);
      if (!response.ok) {
        throw new Error("No se pudo cargar el archivo de búsqueda.");
      }
      const data = await response.json();

      return data.filter((item) =>
        item.title.toLowerCase().includes(query.toLowerCase())
      );
    } catch (error) {
      console.error("Error al buscar:", error);
      return [];
    }
  }

  function renderResults(results) {
    const resultsContainer = document.getElementById("search-results");
    resultsContainer.innerHTML = "";

    if (results.length === 0) {
      resultsContainer.innerHTML =
        "<p>No se encontraron resultados para tu búsqueda.</p>";
      return;
    }

    const ul = document.createElement("ul");
    results.forEach((item) => {
      const li = document.createElement("li");
      li.innerHTML = `<a href="${item.url}" aria-label="Ir a ${item.title}">${item.title}</a>`;
      ul.appendChild(li);
    });
    resultsContainer.appendChild(ul);
  }

  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param) || "";
  }

  const searchInput = document.getElementById("search-input");
  searchInput.addEventListener("input", (e) => {
    const query = e.target.value.trim();
    if (query.length >= 3) {
      fetchSearchData(query).then(renderResults);
    } else if (query.length === 0) {
      renderResults([]);
    }
  });

  const initialQuery = getQueryParam("q");
  if (initialQuery) {
    searchInput.value = initialQuery;
    fetchSearchData(initialQuery).then(renderResults);
  }
</script>
