<nav class="navbar is-fixed-top" aria-label="Menú principal" role="navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="{{ '/' | relative_url }}">
        <h1 class="title is-4 mb-0">El Rincón de Hattrick</h1>
      </a>

      <button
        class="navbar-burger"
        aria-label="Menú"
        aria-expanded="false"
        aria-controls="navbarMenu"
      >
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </button>
    </div>

    <div id="navbarMenu" class="navbar-menu">
      <div class="navbar-end">
        <a
          class="navbar-item {% if page.url == '/' %}is-active{% endif %}"
          href="{{ '/' | relative_url }}"
          role="menuitem"
        >
          <span class="icon-text">
            <span class="icon"><i class="fas fa-home"></i></span>
            <span>Inicio</span>
          </span>
        </a>

        <!-- Aquí comenzamos a manejar las categorías -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a
            class="navbar-link"
            id="category-toggle"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <span class="icon-text">
              <span class="icon"><i class="fas fa-folder"></i></span>
              <span>Categorías</span>
            </span>
          </a>
          <div class="navbar-dropdown" id="category-menu">
            {% if site.pages %} {% for category_page in site.pages %} {% if
            category_page.layout == "category" %}
            <a
              class="navbar-item {% if page.url contains category_page.permalink %}is-active{% endif %}"
              href="{{ category_page.permalink }}"
              role="menuitem"
            >
              <span class="icon-text">
                <span class="icon"
                  ><i class="fas {{ category_page.icon }}"></i
                ></span>
                <span>{{ category_page.title }}</span>
              </span>
            </a>
            {% endif %} {% endfor %} {% else %}
            <a class="navbar-item" role="menuitem"
              >No hay categorías disponibles</a
            >
            {% endif %}
          </div>
        </div>

        <a
          class="navbar-item {% if page.url contains '/acerca-de/' %}is-active{% endif %}"
          href="{{ '/acerca-de/' | relative_url }}"
          role="menuitem"
        >
          <span class="icon-text">
            <span class="icon"><i class="fas fa-info-circle"></i></span>
            <span>Acerca de</span>
          </span>
        </a>

        <a
          class="navbar-item {% if page.url contains '/contacto/' %}is-active{% endif %}"
          href="{{ '/contacto/' | relative_url }}"
          role="menuitem"
        >
          <span class="icon-text">
            <span class="icon"><i class="fas fa-envelope"></i></span>
            <span>Contáctanos</span>
          </span>
        </a>

        <a
          class="navbar-item"
          href="https://www.hattrick.org/?inviteRef=U8EHM5"
          target="_blank"
          rel="noopener noreferrer"
          role="menuitem"
        >
          <span class="icon-text">
            <span class="icon"><i class="fas fa-external-link-alt"></i></span>
            <span>Hattrick</span>
          </span>
        </a>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const burger = document.querySelector(".navbar-burger");
    const menu = document.querySelector(".navbar-menu");
    const categoryToggle = document.getElementById("category-toggle");
    const categoryMenu = document.getElementById("category-menu");

    // Toggle del menú hamburguesa
    if (burger && menu) {
      burger.addEventListener("click", () => {
        const isActive = menu.classList.contains("is-active");
        menu.classList.toggle("is-active");
        burger.classList.toggle("is-active");
        burger.setAttribute("aria-expanded", !isActive);
      });

      // Cerrar el menú al hacer clic fuera
      document.addEventListener("click", (event) => {
        if (!menu.contains(event.target) && !burger.contains(event.target)) {
          menu.classList.remove("is-active");
          burger.classList.remove("is-active");
          burger.setAttribute("aria-expanded", "false");
        }
      });
    }

    // Toggle del menú de Categorías en móviles
    if (categoryToggle && categoryMenu) {
      categoryToggle.addEventListener("click", (event) => {
        if (window.innerWidth <= 1024) {
          event.preventDefault(); // Evitar el comportamiento del enlace en móvil
          categoryMenu.classList.toggle("is-active");
          categoryToggle.setAttribute(
            "aria-expanded",
            categoryMenu.classList.contains("is-active")
          );
        }
      });
    }
  });
</script>

<style>
  @media screen and (max-width: 1024px) {
    /* El menú de categorías se oculta por defecto */
    .navbar-dropdown {
      display: none;
    }

    /* Cuando se activa, se muestra */
    .navbar-dropdown.is-active {
      display: block;
    }
  }
</style>
